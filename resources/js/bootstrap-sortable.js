!function(t,e){"use strict";"function"==typeof define&&define.amd?define("tinysort",function(){return e}):t.tinysort=e}(this,function(){"use strict";function C(t,e){for(var r,a=t.length,o=a;o--;)e(t[r=a-o-1],r)}function s(t,e,r){for(var a in e)(r||t[a]===F)&&(t[a]=e[a]);return t}function t(t,e,r){k.push({prepare:t,sort:e,sortBy:r})}var F,e,N=!1,d=null,r=window,E=r.document,A=parseFloat,q=/(-?\d+\.?\d*)\s*$/g,M=/(\d+\.?\d*)\s*$/g,k=[],D=0,z=0,Y=String.fromCharCode(4095),H={selector:d,order:"asc",attr:d,data:d,useVal:N,place:"org",returns:N,cases:N,natural:N,forceStrings:N,ignoreDashes:N,sortFunction:d,useFlex:N,emptyEnd:N};return r.Element&&((e=Element.prototype).matchesSelector=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(t){for(var e=(this.parentNode||this.document).querySelectorAll(t),r=-1;e[++r]&&e[r]!=this;);return!!e[r]}),s(t,{loop:C}),s(function(t,e){function r(t){var e=!!t.selector,r=e&&":"===t.selector[0],a=s(t||{},H);y.push(s({hasSelector:e,hasAttr:!(a.attr===d||""===a.attr),hasData:a.data!==d,hasFilter:r,sortReturnNumber:"asc"===a.order?1:-1},a))}function f(t,e,r){for(var a=r(t.toString()),o=r(e.toString()),n=0;a[n]&&o[n];n++)if(a[n]!==o[n]){var s=Number(a[n]),i=Number(o[n]);return s==a[n]&&i==o[n]?s-i:a[n]>o[n]?1:-1}return a.length-o.length}function h(t){for(var e,r,a=[],o=0,n=-1,s=0;e=(r=t.charAt(o++)).charCodeAt(0);){var i=46==e||48<=e&&e<=57;i!==s&&(a[++n]="",s=i),a[n]+=r}return a}function l(){return w.forEach(function(t){a.appendChild(t.elm)}),a}function c(t){var e=t.elm,r=E.createElement("div");return t.ghost=r,e.parentNode.insertBefore(r,e),t}function u(t,e){var r=t.ghost,a=r.parentNode;a.insertBefore(e,r),a.removeChild(r),delete t.ghost}function p(t,e){var r,a=t.elm;return e.selector&&(e.hasFilter?a.matchesSelector(e.selector)||(a=d):a=a.querySelector(e.selector)),e.hasAttr?r=a.getAttribute(e.attr):e.useVal?r=a.value||a.getAttribute("value"):e.hasData?r=a.getAttribute("data-"+e.data):a&&(r=a.textContent),v(r)&&(e.cases||(r=r.toLowerCase()),r=r.replace(/\s+/g," ")),null===r&&(r=Y),r}function v(t){return"string"==typeof t}v(t)&&(t=E.querySelectorAll(t)),0===t.length&&console.warn("No elements to sort");var m,g,a=E.createDocumentFragment(),b=[],w=[],i=[],y=[],S=!0,o=t.length&&t[0].parentNode,n=o.rootNode!==document,x=t.length&&(e===F||!1!==e.useFlex)&&!n&&-1!==getComputedStyle(o,null).display.indexOf("flex");return function(){0===arguments.length?r({}):C(arguments,function(t){r(v(t)?{selector:t}:t)}),D=y.length}.apply(d,Array.prototype.slice.call(arguments,1)),C(t,function(t,e){g?g!==t.parentNode&&(S=!1):g=t.parentNode;var r=y[0],a=r.hasFilter,o=r.selector,n=!o||a&&t.matchesSelector(o)||o&&t.querySelector(o)?w:i,s={elm:t,pos:e,posn:n.length};b.push(s),n.push(s)}),m=w.slice(0),w.sort(function(t,e){var r=0;for(0!==z&&(z=0);0===r&&z<D;){var a=y[z],o=a.ignoreDashes?M:q;if(C(k,function(t){var e=t.prepare;e&&e(a)}),a.sortFunction)r=a.sortFunction(t,e);else if("rand"==a.order)r=Math.random()<.5?1:-1;else{var n=N,s=p(t,a),i=p(e,a),d=""===s||s===F,l=""===i||i===F;if(s===i)r=0;else if(a.emptyEnd&&(d||l))r=d&&l?0:d?1:-1;else{if(!a.forceStrings){var c=v(s)?s&&s.match(o):N,u=v(i)?i&&i.match(o):N;c&&u&&s.substr(0,s.length-c[0].length)==i.substr(0,i.length-u[0].length)&&(n=!N,s=A(c[0]),i=A(u[0]))}r=s===F||i===F?0:a.natural&&(isNaN(s)||isNaN(i))?f(s,i,h):s<i?-1:i<s?1:0}}C(k,function(t){var e=t.sort;e&&(r=e(a,n,s,i,r))}),0==(r*=a.sortReturnNumber)&&z++}return 0===r&&(r=t.pos>e.pos?1:-1),r}),function(){var t=w.length===b.length;if(S&&t)x?w.forEach(function(t,e){t.elm.style.order=e}):g?g.appendChild(l()):console.warn("parentNode has been removed");else{var e=y[0].place,r="start"===e,a="end"===e,o="first"===e,n="last"===e;if("org"===e)w.forEach(c),w.forEach(function(t,e){u(m[e],t.elm)});else if(r||a){var s=m[r?0:m.length-1],i=s&&s.elm.parentNode,d=i&&(r&&i.firstChild||i.lastChild);d&&(d!==s.elm&&(s={elm:d}),c(s),a&&i.appendChild(s.ghost),u(s,l()))}else(o||n)&&u(c(m[o?0:m.length-1]),l())}}(),w.map(function(t){return t.elm})},{plugin:t,defaults:H})}()),function(t,e){"function"==typeof define&&define.amd?define(["jquery","tinysort","moment"],e):e(t.jQuery,t.tinysort,t.moment||void 0)}(this,function(m,r,o){var g,b,w,t=m(document);function e(t){var a=void 0!==o;g=t.sign?t.sign:"arrow","default"==t.customSort&&(t.customSort=n),b=t.customSort||b||n,w=t.emptyEnd,m("table.sortable").each(function(){var r=m(this),n=!0===t.applyLast;r.find("span.sign").remove(),r.find("> thead [colspan]").each(function(){for(var t=parseFloat(m(this).attr("colspan")),e=1;e<t;e++)m(this).after('<th class="colspan-compensate">')}),r.find("> thead [rowspan]").each(function(){for(var t=m(this),e=parseFloat(t.attr("rowspan")),r=1;r<e;r++){var a=t.parent("tr"),o=a.next("tr"),n=a.children().index(t);o.children().eq(n).before('<th class="rowspan-compensate">')}}),r.find("> thead tr").each(function(r){m(this).find("th").each(function(t){var e=m(this);e.addClass("nosort").removeClass("up down"),e.attr("data-sortcolumn",t),e.attr("data-sortkey",t+"-"+r)})}),r.find("> thead .rowspan-compensate, .colspan-compensate").remove(),r.find("th").each(function(){var e=m(this);if(void 0!==e.attr("data-dateformat")&&a){var t=parseFloat(e.attr("data-sortcolumn"));r.find("td:nth-child("+(t+1)+")").each(function(){var t=m(this);t.attr("data-value",o(t.text(),e.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss"))})}else if(void 0!==e.attr("data-valueprovider")){t=parseFloat(e.attr("data-sortcolumn"));r.find("td:nth-child("+(t+1)+")").each(function(){var t=m(this);t.attr("data-value",new RegExp(e.attr("data-valueprovider")).exec(t.text())[0])})}}),r.find("td").each(function(){var t=m(this);void 0!==t.attr("data-dateformat")&&a?t.attr("data-value",o(t.text(),t.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")):void 0!==t.attr("data-valueprovider")?t.attr("data-value",new RegExp(t.attr("data-valueprovider")).exec(t.text())[0]):void 0===t.attr("data-value")&&t.attr("data-value",t.text())});var s=S(r),i=s.bsSort;r.find('> thead th[data-defaultsort!="disabled"]').each(function(t){var e=m(this),r=e.closest("table.sortable");e.data("sortTable",r);var a=e.attr("data-sortkey"),o=n?s.lastSort:-1;i[a]=n?i[a]:e.attr("data-defaultsort"),void 0!==i[a]&&n===(a===o)&&(i[a]="asc"===i[a]?"desc":"asc",x(e,r))})})}function y(t){t.find("> tbody [rowspan]").each(function(){var t=m(this),e=parseFloat(t.attr("rowspan"));t.removeAttr("rowspan");var r=t.attr("rowspan-group")||function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}();t.attr("rowspan-group",r),t.attr("rowspan-value",e);for(var a=t.parent("tr"),o=a.children().index(t),n=1;n<e;n++){var s=t.clone(!1),i=a.next("tr");i.children().eq(o).before(s),a=i}})}function a(t){var e=m(t);x(e,e.data("sortTable")||e.closest("table.sortable"))}function S(t){var a=t.data("bootstrap-sortable-context");return void 0===a&&(a={bsSort:[],lastSort:void 0},t.find('> thead th[data-defaultsort!="disabled"]').each(function(t){var e=m(this),r=e.attr("data-sortkey");a.bsSort[r]=e.attr("data-defaultsort"),void 0!==a.bsSort[r]&&(a.lastSort=r)}),t.data("bootstrap-sortable-context",a)),a}function n(t,e){r(t,e)}function x(t,r){r.trigger("before-sort"),y(r);var e=parseFloat(t.attr("data-sortcolumn")),a=S(r),o=a.bsSort;if(t.attr("colspan")){var n=parseFloat(t.data("mainsort"))||0,s=parseFloat(t.data("sortkey").split("-").pop());if(r.find("> thead tr").length-1>s)return void x(r.find('[data-sortkey="'+(e+n)+"-"+(s+1)+'"]'),r);e+=n}var i=t.attr("data-defaultsign")||g;if(r.find("> thead th").each(function(){m(this).removeClass("up").removeClass("down").addClass("nosort")}),m.browser.mozilla){var d=r.find("> thead div.mozilla");void 0!==d&&(d.find(".sign").remove(),d.parent().html(d.html())),t.wrapInner('<div class="mozilla"></div>'),t.children().eq(0).append('<span class="sign '+i+'"></span>')}else r.find("> thead span.sign").remove(),t.append('<span class="sign '+i+'"></span>');var l=t.attr("data-sortkey"),c="desc"!==t.attr("data-firstsort")?"desc":"asc",u=o[l]||c;a.lastSort!==l&&void 0!==o[l]||(u="asc"===u?"desc":"asc"),o[l]=u,"desc"===o[a.lastSort=l]?(t.find("span.sign").addClass("up"),t.addClass("up").removeClass("down nosort")):t.addClass("down").removeClass("up nosort");var f=r.children("tbody").children("tr"),h=[];m(f.filter('[data-disablesort="true"]').get().reverse()).each(function(t,e){var r=m(e);h.push({index:f.index(r),row:r}),r.remove()});var p=f.not('[data-disablesort="true"]');if(0!=p.length){var v="asc"===o[l]&&w;b(p,{emptyEnd:v,selector:"td:nth-child("+(e+1)+")",order:o[l],data:"value"})}m(h.reverse()).each(function(t,e){0===e.index?r.children("tbody").prepend(e.row):r.children("tbody").children("tr").eq(e.index-1).after(e.row)}),r.find("> tbody > tr > td.sorted,> thead th.sorted").removeClass("sorted"),p.find("td:eq("+e+")").addClass("sorted"),t.addClass("sorted"),r.find("> tbody [rowspan-group]").each(function(){for(var t=m(this),e=t.attr("rowspan-group"),r=t.parent("tr"),a=r.children().index(t);;){var o=r.next("tr");if(!o.is("tr"))break;var n=o.children().eq(a);if(n.attr("rowspan-group")!==e)break;var s=parseFloat(t.attr("rowspan"))||1;t.attr("rowspan",s+1),n.remove(),r=o}}),r.trigger("sorted")}if(m.bootstrapSortable=function(t){null==t?e({}):t.constructor===Boolean?e({applyLast:t}):void 0!==t.sortingHeader?a(t.sortingHeader):e(t)},t.on("click",'table.sortable>thead th[data-defaultsort!="disabled"]',function(t){a(this)}),!m.browser){m.browser={chrome:!1,mozilla:!1,opera:!1,msie:!1,safari:!1};var s=navigator.userAgent;m.each(m.browser,function(t){m.browser[t]=!!new RegExp(t,"i").test(s),m.browser.mozilla&&"mozilla"===t&&(m.browser.mozilla=!!new RegExp("firefox","i").test(s)),m.browser.chrome&&"safari"===t&&(m.browser.safari=!1)})}m(m.bootstrapSortable)});